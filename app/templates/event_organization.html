<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ 'Organisation' if lang == 'fr' else '‰ºÅÁîª' }} - {{ event.name }}</title>

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico?v=2">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png?v=2">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png?v=2">
    <link rel="apple-touch-icon" sizes="64x64" href="/static/favicon-64x64.png?v=2">
    <script src="/static/css/tailwind.min.js"></script>
    <script defer src="/static/css/alpine.min.js"></script>
</head>
<body class="bg-gray-50" x-data="{
    darkMode: localStorage.getItem('darkMode') === 'true' || false,
    toggleDarkMode() {
        this.darkMode = !this.darkMode;
        localStorage.setItem('darkMode', this.darkMode);
    }
}">
    <div :class="darkMode ? 'dark bg-gray-900' : 'bg-gray-50'" class="min-h-screen">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
            <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <a href="/events/{{ event.id }}?lang={{ lang }}" class="text-blue-600 dark:text-blue-400 hover:underline">
                        ‚Üê {{ S('back') }}
                    </a>
                    <h1 class="text-2xl font-bold text-gray-900 dark:text-white">
                        {{ 'Organisation' if lang == 'fr' else '‰ºÅÁîª' }} - {{ event.name }}
                    </h1>
                </div>

                <div class="flex items-center gap-4">
                    <!-- S√©lecteur de langue -->
                    <div class="flex gap-2">
                        <a href="?lang=fr"
                           class="px-3 py-1.5 rounded-lg {{ 'bg-blue-500 text-white' if lang == 'fr' else 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600' }}">
                            FR
                        </a>
                        <a href="?lang=jp"
                           class="px-3 py-1.5 rounded-lg {{ 'bg-blue-500 text-white' if lang == 'jp' else 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600' }}">
                            JP
                        </a>
                    </div>

                    <!-- Toggle mode sombre -->
                    <button @click="toggleDarkMode()"
                            class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600">
                        <span x-show="!darkMode">üåô</span>
                        <span x-show="darkMode">‚òÄÔ∏è</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Contenu principal -->
        <main class="max-w-7xl mx-auto px-4 py-8">
            <!-- Bouton pour modifier la planification -->
            <div class="mb-6 flex justify-end">
                <a href="/events/{{ event.id }}/planning?lang={{ lang }}"
                   class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                    <span>‚úèÔ∏è</span>
                    <span>{{ 'Modifier la planification' if lang == 'fr' else '„Éó„É©„É≥„Éã„É≥„Ç∞„ÇíÁ∑®ÈõÜ' }}</span>
                </a>
            </div>

            {% if planning_by_date %}
            <!-- Grille des jours avec recettes -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for date, day_info in planning_by_date.items() %}
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden border-2 border-gray-200 dark:border-gray-700">
                    <!-- En-t√™te de la date -->
                    <div class="bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-3">
                        <h3 class="text-white font-bold text-lg">
                            {{ day_info.date }}
                        </h3>
                    </div>

                    <!-- Liste des recettes du jour -->
                    <div class="p-4">
                        {% if day_info.recipes %}
                        <div class="space-y-3">
                            {% for recipe in day_info.recipes %}
                            <a href="/recipe/{{ recipe.slug }}?lang={{ lang }}&from_event={{ event.id }}"
                               class="block group">
                                <div class="flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors border border-gray-200 dark:border-gray-600">
                                    <!-- Image de la recette (ic√¥ne) -->
                                    {% if recipe.thumbnail_url %}
                                    <img src="{{ recipe.thumbnail_url }}"
                                         alt="{{ recipe.name }}"
                                         class="w-16 h-16 object-cover rounded-lg">
                                    {% else %}
                                    <div class="w-16 h-16 bg-gray-300 dark:bg-gray-600 rounded-lg flex items-center justify-center text-2xl">
                                        üçΩÔ∏è
                                    </div>
                                    {% endif %}

                                    <!-- Nom de la recette -->
                                    <div class="flex-1">
                                        <p class="font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400">
                                            {{ recipe.name }}
                                        </p>
                                        <p class="text-sm text-gray-500 dark:text-gray-400">
                                            {{ '‚Ññ' }} {{ recipe.position + 1 }}
                                        </p>
                                    </div>

                                    <!-- Ic√¥ne de lien -->
                                    <svg class="w-5 h-5 text-gray-400 group-hover:text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                    </svg>
                                </div>
                            </a>
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                            <p class="text-4xl mb-2">üì≠</p>
                            <p>{{ 'Aucune recette planifi√©e' if lang == 'fr' else '„É¨„Ç∑„Éî„ÅåË®àÁîª„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì' }}</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <!-- Message si aucune planification -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-12 text-center">
                <div class="text-6xl mb-4">üìÖ</div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
                    {{ 'Aucune organisation d√©finie' if lang == 'fr' else '‰ºÅÁîª„ÅåÊú™ÂÆöÁæ©„Åß„Åô' }}
                </h2>
                <p class="text-gray-600 dark:text-gray-400 mb-6">
                    {{ 'Cliquez sur le bouton ci-dessus pour commencer √† planifier vos recettes par jour' if lang == 'fr' else '‰∏ä„ÅÆ„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„ÄÅÊó•„Åî„Å®„Å´„É¨„Ç∑„Éî„ÇíË®àÁîª„ÅóÂßã„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ' }}
                </p>
                <a href="/events/{{ event.id }}/planning?lang={{ lang }}"
                   class="inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium">
                    <span>‚úèÔ∏è</span>
                    <span>{{ 'Cr√©er la planification' if lang == 'fr' else '„Éó„É©„É≥„Éã„É≥„Ç∞„Çí‰ΩúÊàê' }}</span>
                </a>
            </div>
            {% endif %}
        </main>
    </div>
</body>
</html>
